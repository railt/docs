# Загрузка зависимостей

Не всегда удобно хранить все GraphQL типы в одном большом файле. Для того, 
чтобы иметь возможность подгружать разные файлы, Railt предоставляет
инструмент принудительной и ленивой автозагрузки файлов.

Для того, чтобы сконфигурировать нужные пути воспользуйтесь нам нужно 
модифицировать файл `composer.json`.

## Автозагрузка

Автозагрузка - это "ленивая" система подключения файлов, которая скомпилирует 
нужные файлы в тот момент, когда компилятор пытается собрать схему и не находит 
подходящий и уже скомпилированный тип.

### Автозагрузка директории

Давайте добавим директорию `resources/graphql/*` в качестве пути, по которому
будет производиться поиск недостающих типов.

```json
{
    "extra": {
        "railt": {
            "autoload": {
                "paths": [
                    "${app.dir}/resources/graphql/"
                ]
            }
        } 
    }
}
```

?> Обратите внимание на переменную `${app.dir}`. Она всегда указывает на корень 
приложения. В том случае, если вы пишите пакет или расширение, которое 
использует Railt Discovery - воспользуйтесь переменной `${package.dir}`.  

В данном случае, при попытке подгрузить какой-нибудь тип `User` - 
будет произведён поиск файла `User.graphqls` (или `graphql`) 
по пути `~/resources/graphql/User.graphqls`.

!> Обратите внимание, что для именования типов используется CamelCase, 
аналогичный имени типу, определённому в файле.

### Расширения автозагрузки

По умолчанию, во время автозагрузки, производится поиск файлов с 
расширениями `.graphqls` и `.graphql`. Для того, чтобы добавить своё - 
достаточно прописать его в секции `extension` файла `composer.json`.

```json
{
    "extra": {
        "railt": {
            "autoload": {
                "extensions": [
                    "gql"
                ]
            }
        }
    }
}
```

Для исключения какого-либо расширения воспользуйтесь секцией `exclude`.

```json
{
    "extra": {
        "discovery": {
            "railt": {
                "exclude": [
                    "autoload.extensions.graphql"
                ]
            }
        }
    }
}
```

### Автозагрузка файлов

В том случае, если не требуется поиск в директории, то можно указать
автозагрузчику на конкретный файл.

```json
{
    "extra": {
        "railt": {
            "autoload": {
                "files": [
                    "${app.dir}/resources/graphql/User.graphqls"
                ]
            }
        }
    }
}
```

## Предзагрузка

Предзагрузка - это махеанизм, аналогичный автозагрузке. Однако, всё, 
указанное в секции `preload` будет загружено всегда в явном виде. Таким 
образом можно реализовать расширения для каких-либо типов, которые не могут 
быть загружены лениво. 

### Предзагрузка файлов

Например, если мы определим extension для типа Query:

```graphql
extend type Query {
    users: [User!]! @route(action: "UsersController@all")
}
```

То мы можем его подключить используя секцию `files` в файле `composer.json` 
следующим образом:

```json
{
    "extra": {
        "railt": {
            "preload": {
                "files": [
                    "${app.dir}/resources/graphql/query-users-extension.graphqls"
                ]
            }
        }
    }
}
```
